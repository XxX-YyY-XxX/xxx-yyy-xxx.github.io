<!DOCTYPE html>
<html>
    <head>
        <meta charset='utf-8'>
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="/assets/css/style.css?v=2d3b5126dd9bdaf552f3aef918356c51b10c15a9">
        <link rel="stylesheet" href="/externalcss.css">

        <!-- start custom head snippets, customize with your own _includes/head-custom.html file -->
            <!-- Setup theme-color -->

            <!-- start theme color meta headers -->
            <meta name="theme-color" content="#151515">
            <meta name="msapplication-navbutton-color" content="#151515">
            <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
            <!-- end theme color meta headers -->

            <!-- Setup Google Analytics -->

            <!-- You can set your favicon here -->
            <link rel="icon" type="image/png" href="/univasset/Favicon.png">
        <!-- end custom head snippets -->

        <!-- Begin Jekyll SEO tag v2.8.0 -->
        <title>Random Scraps | GFL FAQs first. Might add things later.</title>
        <meta name="generator" content="Jekyll v3.9.0" />
        <meta property="og:title" content="Random Scraps" />
        <meta property="og:locale" content="en_US" />
        <meta name="description" content="GFL FAQs first. Might add things later." />
        <meta property="og:description" content="GFL FAQs first. Might add things later." />
        <link rel="canonical" href="https://xxx-yyy-xxx.github.io/" />
        <meta property="og:url" content="https://xxx-yyy-xxx.github.io/" />
        <meta property="og:site_name" content="Random Scraps" />
        <meta property="og:type" content="website" />
        <meta name="twitter:card" content="summary" />
        <meta property="twitter:title" content="Random Scraps" />
        <script type="application/ld+json">
        {"@context":"https://schema.org","@type":"WebSite","description":"GFL FAQs first. Might add things later.","headline":"Random Scraps","name":"Random Scraps","url":"https://xxx-yyy-xxx.github.io/"}</script>
        <!-- End Jekyll SEO tag -->
    </head>

    <body>
        <header>
            <div class="container">
                <a id="a-title" href="/"><h1>Random Scraps</h1></a>
                <h2>Trial HTML Index Page</h2>
            </div>
        </header>

        <div class="container">
            <section id="main_content">

                <p>Use <code>Tags:</code> to search using tags.</p>

                <form onsubmit="findCards()">
                    <input type="text" placeholder="Search..." id="search-text">
                    <input type="submit">
                </form>
                
                <div id="qna"></div>

            </section>
        </div>

        <!--script src="/GFL/cards.json"></script-->
        <script type="text/javascript" src="/externaljavascript.js"></script>
        <script>
            //const questionCards = require('/GFL/cards.json');

            /* const questionCards = fetch('/GFL/cards.json')
                .then(response => response.json() )
                .then(data => appendData(data) )
                .catch(err => console.log(err) );
            */

            /* var oXHR = window.XMLHttpRequest ? new XMLHttpRequest() : new ActiveXObject('Microsoft.XMLHTTP');
            oXHR.onreadystatechange = function() {
                if (oXHR.readyState === 4 && oXHR.status == "200")
                    questionCards = JSON.parse(this.responseText);
            };
            oXHR.overrideMimeType("application/json");
            oXHR.open("GET", "/GFL/cards.json", true);          // true = ASYNCHRONOUS REQUEST (DESIRABLE), false = SYNCHRONOUS REQUEST.
            oXHR.send(); */

            var boxes = '';
            var questionCards;

            questionCards = [
                {
                    "questions" : "a",
                    "answers" : "1",
                    "tags" : ["z", "s"]
                },
                {
                    "questions" : "b",
                    "answers" : "2",
                    "tags" : ["y"]
                },
                {
                    "questions" : "c",
                    "answers" : "3",
                    "tags" : ["x"]
                },
                {
                    "questions" : "d",
                    "answers" : "4",
                    "tags" : ["w"]
                },
                {
                    "questions" : "e",
                    "answers" : "5",
                    "tags" : ["v"]
                }
            ]
            
            if (sessionStorage.outputCards) {
                document.getElementById("qna").innerHTML = sessionStorage.outputCards;
            } else {
                randomCards();
                document.getElementById("qna").innerHTML = boxes;
            }            

            function findCards() {                                         //run on pressing search
                let searchText = document.getElementById('search-text').value;

                if (searchText.includes('Tags:')) {
                    const cardTags = searchText.replace('Tags:', '').split(' ').filter(singleTags => singleTags !== '');
                } else {
                    const phrase = `/${searchText}/i`
                }

                for (let cards of questionCards) {    
                    if (cards.questions.search(phrase) > -1 || cards.answers.search(phrase) > -1 || IsSubsetOf(cardTags, cards.tags)) {
                        boxes += setQuestionBoxes(cards)
                    }
                }

                if (typeof(Storage) !== "undefined") {
                    sessionStorage.outputCards = boxes;
                } else {
                    sessionStorage.outputCards = "Sorry, your browser does not support web storage...";
                } 
            }

            function randomCards() {
                let maxValue = questionCards.length;
                var indices = []

                for (let i = 0; i < 5; i++) {
                    do {
                        var newItem = Math.floor(Math.random() * maxValue)
                    } while (indices.includes(newItem))
                    indices.push(newItem);
                }

                for (let index of indices) {
                    boxes += setQuestionBoxes(questionCards[index])
                }
            }

            function setQuestionBoxes(cards) {
                //let tagList = cards.tags.map(tagObject => {`<span class="tags">${tagObject}</span>`})
                
                return `<fieldset>
                    <legend><h3>${cards.questions}</h3></legend>
                    <blockquote>${cards.answers}</blockquote>
                    <br></br>
                    Tags: <span class="tags">${cards.tags}</span>
                    </fieldset>`;
            }
        </script>
    </body>
</html>