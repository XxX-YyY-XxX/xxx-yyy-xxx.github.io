<!DOCTYPE html>
<html>
    <head>
        <meta charset='utf-8'>
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="/assets/css/style.css?v=2d3b5126dd9bdaf552f3aef918356c51b10c15a9">
        <link rel="stylesheet" href="/externalcss.css">

        <!-- start custom head snippets, customize with your own _includes/head-custom.html file -->
            <!-- Setup theme-color -->

            <!-- start theme color meta headers -->
            <meta name="theme-color" content="#151515">
            <meta name="msapplication-navbutton-color" content="#151515">
            <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
            <!-- end theme color meta headers -->

            <!-- Setup Google Analytics -->

            <!-- You can set your favicon here -->
            <link rel="icon" type="image/png" href="/univasset/Favicon.png">
        <!-- end custom head snippets -->

        <!-- Begin Jekyll SEO tag v2.8.0 -->
        <title>GFL FAQs | Random Scraps.</title>
        <meta name="generator" content="Jekyll v3.9.0" />
        <meta property="og:title" content="Random Scraps" />
        <meta property="og:locale" content="en_US" />
        <meta name="description" content="GFL FAQs." />
        <meta property="og:description" content="GFL FAQs." />
        <link rel="canonical" href="https://xxx-yyy-xxx.github.io/" />
        <meta property="og:url" content="https://xxx-yyy-xxx.github.io/" />
        <meta property="og:site_name" content="Random Scraps" />
        <meta property="og:type" content="website" />
        <meta name="twitter:card" content="summary" />
        <meta property="twitter:title" content="Random Scraps" />
        <script type="application/ld+json">
        {"@context":"https://schema.org","@type":"WebSite","description":"GFL FAQs.","headline":"Random Scraps","name":"Random Scraps","url":"https://xxx-yyy-xxx.github.io/"}</script>
        <!-- End Jekyll SEO tag -->
    </head>

    <style>
        input[type="checkbox"]{
            appearance: none;
            margin: 0px;
        }

        details {
            display: inline;
        }

        summary {
            display: inline;
            color: deeppink;
        }

        .tags {
            outline: 2px solid aqua;
            border-radius: 10rem;
            padding: 0px 3px;
            display: inline-grid;                       /* For making the tag buttons stay together on wrap. */
        }

        .card-tags {
            background: transparent;
            color: aqua;
            line-height: 20px;
        }
        
        .selectedTag {
            background: transparent;
            color: aqua;
        }

        .unselectedTag {
            background: aqua;
            color: black;
        }

        .twitter-tweet iframe {                         /* Needs more responsive solution. Works on first load only. */
            width: inherit;
        }

        .gdoc {
            width: 100%;
            aspect-ratio: 1/1;
        }

        #search-text {
            width: calc(100% - 76px);
        }

        #tags-list {
            text-align: center;
            display: none;                              /* Makes class hidden on default. */
        }
    </style>

    <body>
        <header>
            <div class="container">
                <a id="a-title" href="/"><h1>Random Scraps</h1></a>
                <h2>Girls' Frontline Reddit Lounge FAQs</h2>

                <section id="downloads">
                    <a href="../" class="btn btn-github"><span class="icon"></span>Back</a>
                    <!-- Menu Buttons -->
                </section>
            </div>
        </header>

        <div class="container">
            <section id="main_content">
                <p><h1><a href="./mainpage">Link to topics repository</a></h1></p>
                
                <label><input type="radio" id="search-input" name="input-type" onclick="switchInputMode(this)" checked>Search by keyword</label>
                <label><input type="radio" id="tags-input" name="input-type" onclick="switchInputMode(this)">Search by tags</label>

                <form>
                    <div id="tags-list"></div>

                    <input type="text" id="search-text" placeholder="Search..." name="search">
                    <input type="submit">
                </form>

                <div id="cards-field"></div>
            </section>
        </div>

        <script type="text/javascript" src="/externaljavascript.js"></script>
        <script type="text/javascript" src="/GFL/tempcard.js"></script>
        <script>
            const toggleableTagsField = document.getElementById('tags-list');
            const searchTextField = document.getElementById('search-text');
            const searchParams = new URLSearchParams(location.search);
            const questionCards = cardData;

            toggleableTagsField.innerHTML = Object.values(dataTags).map(val => 
                `<label class="tags unselectedTag" id="${val}-label">
                    <input type="checkbox" id="${val}" onclick="toggleTag(this)">${val}
                </label>` 
            ).join(' ');

            document.getElementById('cards-field').innerHTML = (searchParams.has('search') || searchParams.has('tags')) ? searchCards() : randomCards();

            function switchInputMode(radioButton) {
                searchTextField.name = radioButton.id.replace('-input', '');
                searchTextField.value = '';                        
                switch (radioButton.id) {
                    case 'tags-input':
                        searchTextField.style.display = 'none';
                        toggleableTagsField.style.display = 'block';
                        break;
                    case 'search-input':
                        searchTextField.style.display = 'inline';
                        toggleableTagsField.style.display = 'none';
                        for (const element of Array.from(document.getElementsByClassName('selectedTag'))) {
                            document.getElementById(element.id.replace('-label', '')).checked = false;
                            element.className = 'tags unselectedTag';
                        }                        
                        break;                
                    default:
                        console.log(radioButton.id);
                        break;
                }
            }

            function toggleTag(tagCheckbox) {
                if (tagCheckbox.checked) {
                    document.getElementById(tagCheckbox.id + '-label').className = 'tags selectedTag';
                    searchTextField.value += tagCheckbox.id + ' ';
                } else {
                    document.getElementById(tagCheckbox.id + '-label').className = 'tags unselectedTag';
                    searchTextField.value = searchTextField.value.replace(tagCheckbox.id + ' ', '')
                }
            }

            function searchCards() {
                var output = '';

                if (searchParams.has('tags')) {
                    const cardTags = searchParams.get('tags').split(' ').filter(Boolean);
                    if (cardTags.length > 0) {
                        var matchCheck = function(card) {
                            return IsSubsetOf(cardTags, card.tags);
                        }
                    } else {
                        return 'Empty search.';
                    }
                } else {
                    let searchText = searchParams.get('search');
                    if (searchText) {
                        const phrase = new RegExp(searchText, 'i');
                        var matchCheck = function(card) {
                            return phrase.test(card.questions) || phrase.test(RemoveHTMLTag(card.answers));
                        }
                    } else {
                        return 'Empty search.';
                    }
                }

                for (const cards of questionCards) {
                    if (matchCheck(cards)) {
                        output += setQuestionBoxes(cards);
                    }
                }

                return output || 'No matches found.';
            }

            function randomCards() {
                const maxValue = questionCards.length - 1;
                const indices = new Set();
                var output = '';

                do {
                    indices.add(RandomInteger(0, maxValue));
                } while (indices.size < 3)

                for (const index of indices) {
                    output += setQuestionBoxes(questionCards[index]);
                }

                return output;
            }

            function setQuestionBoxes(cards) {
                return `<fieldset>
                    <legend><h3>${cards.questions}</h3></legend>
                    ${cards.answers}
                    <hr>
                    Tags: ${cards.tags.map(val => `<span class="tags card-tags">${val}</span>` ).join(' ')}
                    </fieldset>`;
            }
        </script>
    </body>
</html>