<!DOCTYPE html>
<html>
    <head>
        <meta charset='utf-8'>
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="/assets/css/style.css?v=2d3b5126dd9bdaf552f3aef918356c51b10c15a9">
        <link rel="stylesheet" href="/externalcss.css">

        <!-- start custom head snippets, customize with your own _includes/head-custom.html file -->
            <!-- Setup theme-color -->

            <!-- start theme color meta headers -->
            <meta name="theme-color" content="#151515">
            <meta name="msapplication-navbutton-color" content="#151515">
            <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
            <!-- end theme color meta headers -->

            <!-- Setup Google Analytics -->

            <!-- You can set your favicon here -->
            <link rel="icon" type="image/png" href="/univasset/Favicon.png">
        <!-- end custom head snippets -->

        <!-- Begin Jekyll SEO tag v2.8.0 -->
        <title>GFL FAQs | Random Scraps.</title>
        <meta name="generator" content="Jekyll v3.9.0" />
        <meta property="og:title" content="Random Scraps" />
        <meta property="og:locale" content="en_US" />
        <meta name="description" content="GFL FAQs." />
        <meta property="og:description" content="GFL FAQs." />
        <link rel="canonical" href="https://xxx-yyy-xxx.github.io/" />
        <meta property="og:url" content="https://xxx-yyy-xxx.github.io/" />
        <meta property="og:site_name" content="Random Scraps" />
        <meta property="og:type" content="website" />
        <meta name="twitter:card" content="summary" />
        <meta property="twitter:title" content="Random Scraps" />
        <script type="application/ld+json">
        {"@context":"https://schema.org","@type":"WebSite","description":"GFL FAQs.","headline":"Random Scraps","name":"Random Scraps","url":"https://xxx-yyy-xxx.github.io/"}</script>
        <!-- End Jekyll SEO tag -->
    </head>

    <style>
        input[type="checkbox"]{
            appearance: none;
            margin: 0px;
        }

        .tags {
            outline: 2px solid aqua;
            border-radius: 10rem;
            padding: 0px 3px;
            display: inline-grid;                       /* For making the tag buttons stay together on wrap. */
        }

        .card-tags {
            background: transparent;
            color: aqua;
            line-height: 20px;
        }
        
        .selectedTag {
            background: transparent;
            color: aqua;
        }

        .unselectedTag {
            background: aqua;
            color: black;
        }

        .twitter-tweet iframe {                         /* Needs more responsive solution. Works on first load only. */
            width: inherit;
        }

        .gdoc {
            width: 100%;
            aspect-ratio: 1/1;
        }

        #search-text {
            width: calc(100% - 76px);
        }

        #tags-list {
            text-align: center;
            display: none;                              /* Makes class hidden on default. */
        }
    </style>

    <body>
        <header>
            <div class="container">
                <a id="a-title" href="/"><h1>Random Scraps</h1></a>
                <h2>Girls' Frontline Reddit Lounge FAQs</h2>
            </div>
            <!-- Menu Buttons -->
        </header>

        <div class="container">
            <section id="main_content">
                <p><h1><a href="/GFL/mainpage">Link to topics repository</a></h1></p>
                
                <label><input type="radio" id="text-input" name="input-type" onclick="textMode()" checked>Search by keyword</label>
                <label><input type="radio" id="tag-input" name="input-type" onclick="tagMode()">Search by tags</label>

                <form onsubmit="findCards()">
                    <div id="tags-list"></div>

                    <input type="text" id="search-text" placeholder="Search...">
                    <input type="submit">
                </form>
    
                <div id="qna"></div>
            </section>
        </div>

        <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
        <script type="text/javascript" src="/externaljavascript.js"></script>
        <script type="text/javascript" src="/GFL/tempcard.js"></script>
        <script>
            const searchTextField = document.getElementById('search-text');
            const cardField = document.getElementById('qna');
            const questionCards = cardData;

            document.getElementById('tags-list').innerHTML = Object.values(dataTags).map(val => 
                `<label class="tags unselectedTag" id="${val}-label">
                    <input type="checkbox" id="${val}" onclick="toggleTag(this)">${val}
                </label>` 
            ).join(' ');
            
            if (sessionStorage.outputCards == null) {
                cardField.innerHTML = randomCards();
            } else if (sessionStorage.outputCards != null) {
                cardField.innerHTML = searchCards();
            } else {                                                            //Catch
                cardField.innerHTML = 'Weird jank: ' + sessionStorage.outputCards;
            }

            function textMode() {
                document.getElementById('search-text').style.display = 'inline';
                document.getElementById('tags-list').style.display = 'none';
                searchTextField.value = '';
                for (const element of Array.from(document.getElementsByClassName('selectedTag'))) {
                    document.getElementById(element.id.replace('-label', '')).checked = false;
                    element.className = 'tags unselectedTag';
                }
            }

            function tagMode() {
                document.getElementById('search-text').style.display = 'none';
                document.getElementById('tags-list').style.display = 'block';
                searchTextField.value = 'Tags:';
            }

            function toggleTag(tagCheckbox) {
                if (tagCheckbox.checked) {
                    document.getElementById(tagCheckbox.id + '-label').className = 'tags selectedTag';
                    searchTextField.value += ' ' + tagCheckbox.id;
                } else {
                    document.getElementById(tagCheckbox.id + '-label').className = 'tags unselectedTag';
                    searchTextField.value = searchTextField.value.replace(' ' + tagCheckbox.id, '')
                }
            }

            function findCards() {                                              //Runs on submit
                sessionStorage.outputCards = searchTextField.value;
            }

            function searchCards() {
                const searchText = sessionStorage.outputCards;
                var output = '';

                if (searchText.includes('Tags:')) {
                    const cardTags = searchText.replace('Tags:', '').split(' ').filter(Boolean);
                    if (cardTags) {
                        var matchCheck = function(card) {
                            return IsSubsetOf(cardTags, card.tags);
                        }
                    } else {
                        return 'Empty search.';
                    }
                } else {
                    if (searchText) {
                        const phrase = new RegExp(searchText, 'i');
                        var matchCheck = function(card) {
                            return phrase.test(card.questions) || phrase.test(RemoveHTMLTag(card.answers));
                        }
                    } else {
                        return 'Empty search.';
                    }
                }

                for (const cards of questionCards) {
                    if (matchCheck(cards)) {
                        output += setQuestionBoxes(cards);
                    }
                }

                return output || 'No matches found.';
            }

            function randomCards() {
                const maxValue = questionCards.length - 1;
                //var indices = [];
                var output = '';

                /* for (let i = 0; i < 3; i++) {
                    do {
                        var newItem = RandomInteger(0, maxValue);
                    } while (indices.includes(newItem))
                    indices.push(newItem);
                } */

                var indices = new Set();

                do {
                    indices.add(RandomInteger(0, maxValue));
                } while (indices.size < 3)

                for (const index of indices) {
                    output += setQuestionBoxes(questionCards[index]);
                }

                return output;
            }

            function setQuestionBoxes(cards) {
                return `<fieldset>
                    <legend><h3>${cards.questions}</h3></legend>
                    ${cards.answers}
                    <hr>
                    Tags: ${cards.tags.map(val => `<span class="tags card-tags">${val}</span>` ).join(' ')}
                    </fieldset>`;
            }
        </script>
    </body>
</html>